doctype: firewall
impl: c2mock.network.Firewall
contents:
  name: Firewall
  description: Provides a network firewall
input:
  region_name: aws/region_name
  sg_name: "%(platform/abbreviation)s-%(platform/short_id)s"
  sg_description: "%(platform/abbreviation)s ingress"
output:
  sg_name: mock/security_group_name
components:
  rules:
    - doctype: firewall_rule
      impl: c2mock.network.FirewallRule
      input:
        cidr_ip: network/admin_cidr
      contents:
        ip_protocol: tcp
    - doctype: firewall_rule
      impl: c2mock.network.FirewallRule
      input:
        cidr_ip: network/admin_cidr
        from_port: network/admin_port
        to_port: network/admin_port